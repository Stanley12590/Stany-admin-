<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STANY MIN ADMIN - SUPREME PRO</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #FF0000;
            --bg: #000000;
            --card: #0a0a0a;
            --border: #1a1a1a;
            --text: #ffffff;
            --gray: #888;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Outfit', sans-serif; outline: none; }
        body { background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }

        /* SIDEBAR */
        .sidebar { width: 260px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; }
        .nav-item { padding: 12px 15px; border-radius: 15px; cursor: pointer; margin-bottom: 8px; display: flex; align-items: center; gap: 12px; color: #888; transition: 0.3s; font-size: 0.9em; font-weight: 600; }
        .nav-item:hover, .nav-item.active { background: var(--primary); color: #fff; }

        /* MAIN CONTENT */
        .main { flex: 1; overflow-y: auto; padding: 30px; padding-bottom: 100px; }
        .section { display: none; }
        .section.active { display: block; animation: slideIn 0.4s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS & FORMS */
        .app-card { background: var(--card); border: 1px solid var(--border); padding: 25px; border-radius: 25px; margin-bottom: 25px; }
        .input-box, .select-modern { width: 100%; padding: 14px; background: #000; border: 1px solid #222; color: white; border-radius: 15px; margin-bottom: 15px; font-size: 0.9em; }
        .btn { padding: 12px 25px; border-radius: 18px; border: none; font-weight: 800; cursor: pointer; background: var(--primary); color: #fff; transition: 0.3s; }
        .btn-d { background: #222; }

        /* CHAT & TOKEN LISTS */
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #050505; border: 1px solid #111; border-radius: 18px; margin-bottom: 10px; }
        .token-code { color: var(--primary); font-weight: 900; font-family: monospace; letter-spacing: 1px; }
        .user-label { font-size: 11px; color: #555; display: block; margin-top: 4px; }

        /* AUTH */
        #authOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 30000; display: flex; justify-content: center; align-items: center; }
        
        #toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: var(--primary); color: white; padding: 10px 30px; border-radius: 30px; z-index: 50000; display: none; font-weight: 800; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }
    </style>
</head>
<body>

    <!-- AUTH OVERLAY -->
    <div id="authOverlay">
        <div class="app-card" style="width:350px; text-align:center;">
            <h2 style="color:var(--primary); margin-bottom:20px; font-family: 'Orbitron';">ADMIN LOGIN</h2>
            <input type="email" id="adminEmail" class="input-box" placeholder="Email">
            <input type="password" id="adminPass" class="input-box" placeholder="Password">
            <button class="btn" style="width: 100%;" onclick="login()">ENTER PANEL</button>
        </div>
    </div>

    <!-- SIDEBAR -->
    <div class="sidebar">
        <h1 style="color:var(--primary); font-family:'Orbitron'; font-size:20px; margin-bottom:30px;">STANY ADMIN</h1>
        <div class="nav-item active" onclick="showSection('ads')"><i class="fas fa-ad"></i>Ads Pool</div>
        <div class="nav-item" onclick="showSection('tokens')"><i class="fas fa-key"></i>Token Factory</div>
        <div class="nav-item" onclick="showSection('library')"><i class="fas fa-book"></i>Library Builder</div>
        <div class="nav-item" onclick="showSection('content')"><i class="fas fa-film"></i>Content (DRM/Adult)</div>
        <div class="nav-item" onclick="showSection('chat')"><i class="fas fa-comments"></i>Support & Group</div>
        <div class="nav-item" onclick="showSection('users')"><i class="fas fa-users-cog"></i>Users HWID & Pass</div>
        <div class="nav-item" style="margin-top:auto; color:red" onclick="auth.signOut()"><i class="fas fa-sign-out-alt"></i>Logout</div>
    </div>

    <!-- MAIN AREA -->
    <div class="main">
        
        <!-- 1. ADS MANAGER -->
        <div id="ads" class="section active">
            <h2>Ultimate Ads Pool</h2>
            <div class="app-card">
                <label>Ad Type</label>
                <select id="ad-type" class="select-modern"><option value="image">Image</option><option value="video">Video</option></select>
                <input id="ad-header" class="input-box" placeholder="Ad Header (e.g. SPECIAL OFFER)">
                <input id="ad-url" class="input-box" placeholder="Media URL (Image/Video URL)">
                <input id="ad-duration" type="number" class="input-box" placeholder="Ad Duration (Seconds)">
                <label>Sponsor Social Links</label>
                <input id="ad-wa" class="input-box" placeholder="WhatsApp Link">
                <input id="ad-tg" class="input-box" placeholder="Telegram Link">
                <input id="ad-yt" class="input-box" placeholder="YouTube Link">
                <button class="btn" onclick="saveAd()">ADD TO RANDOM POOL</button>
            </div>
            <div id="ads-list"></div>
        </div>

        <!-- 2. TOKEN FACTORY -->
        <div id="tokens" class="section">
            <h2>Premium Token Factory</h2>
            <div class="app-card">
                <input id="tk-value" type="number" class="input-box" placeholder="Value (e.g. 30)">
                <select id="tk-unit" class="select-modern">
                    <option value="seconds">Seconds</option>
                    <option value="minutes">Minutes</option>
                    <option value="hours" selected>Hours</option>
                    <option value="days">Days</option>
                </select>
                <input id="tk-count" type="number" class="input-box" placeholder="How many tokens?">
                <button class="btn" onclick="generateTokens()">GENERATE TOKENS</button>
            </div>
            <div id="tk-list"></div>
        </div>

        <!-- 3. LIBRARY BUILDER -->
        <div id="library" class="section">
            <h2>Simulizi & Tech Builder (Episodes)</h2>
            <div class="app-card">
                <select id="lib-cat" class="select-modern"><option value="simulizi">Simulizi</option><option value="tech">Tech Update</option></select>
                <input id="lib-title" class="input-box" placeholder="Book Title">
                <input id="lib-author" class="input-box" placeholder="Author Name">
                <div id="ep-container">
                    <div class="ep-row" style="background:#000; padding:15px; border-radius:15px; margin-bottom:10px;">
                        <input class="ep-title input-box" placeholder="Part Title (e.g. Episode 1)">
                        <textarea class="ep-content input-box" rows="4" placeholder="Content text..."></textarea>
                    </div>
                </div>
                <button class="btn btn-d" onclick="addEpField()">+ ADD NEXT PART</button>
                <button class="btn" style="margin-top:10px;" onclick="saveLibrary()">PUBLISH BOOK</button>
            </div>
        </div>

        <!-- 4. CONTENT MANAGEMENT -->
        <div id="content" class="section">
            <h2>Movies & Adult Content</h2>
            <div class="app-card">
                <select id="ch-type" class="select-modern">
                    <option value="movies">Regular Movie</option>
                    <option value="adultContent">Adult (18+)</option>
                    <option value="channels">Live Channel</option>
                </select>
                <input id="ch-name" class="input-box" placeholder="Title">
                <input id="ch-url" class="input-box" placeholder="URL">
                <input id="ch-logo" class="input-box" placeholder="Poster URL">
                <select id="ch-player" class="select-modern"><option value="internal">Standard</option><option value="drm">DRM Pro</option></select>
                <input id="ch-license" class="input-box" placeholder="DRM License URL (Optional)">
                <input id="ch-token" class="input-box" placeholder="Token ID (Optional)">
                <button class="btn" onclick="saveContent()">SAVE CONTENT</button>
            </div>
            <div id="content-list"></div>
        </div>

        <!-- 5. CHAT SUPPORT -->
        <div id="chat" class="section">
            <h2>Support Chats & Group Chat</h2>
            <div style="display:flex; gap:10px; margin-bottom:20px;">
                <button class="btn" onclick="loadChatList('supportChats')">PRIVATE (BOT)</button>
                <button class="btn btn-d" onclick="loadChatList('groupChat')">GROUP CHAT</button>
            </div>
            <div id="chat-list" class="app-card"></div>
            <!-- Reply Area -->
            <div id="reply-area" style="display:none;" class="app-card">
                <h4 id="reply-user-title">Reply to: </h4>
                <textarea id="reply-text" class="input-box" rows="3" placeholder="Message..."></textarea>
                <button class="btn" onclick="sendReply()">SEND REPLY</button>
                <button class="btn btn-d" onclick="closeReply()">CLOSE</button>
            </div>
        </div>

        <!-- 6. USER HWID & PASS -->
        <div id="users" class="section">
            <h2>Hardware Lock & User Passwords</h2>
            <div id="user-list"></div>
        </div>

    </div>

    <div id="toast">Saved!</div>

    <script>
        // CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyDiexD5WK9GLhQldr6zNmC8iYWc4em5eyM",
            authDomain: "stany-min-tv.firebaseapp.com",
            databaseURL: "https://stany-min-tv-default-rtdb.firebaseio.com",
            projectId: "stany-min-tv",
            storageBucket: "stany-min-tv.firebasestorage.app",
            messagingSenderId: "16513327552",
            appId: "1:16513327552:web:b4b2247053f83aa0b8e825"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database(), auth = firebase.auth();

        auth.onAuthStateChanged(u => {
            if(u) { document.getElementById('authOverlay').style.display='none'; init(); }
            else { document.getElementById('authOverlay').style.display='flex'; }
        });

        function login() { auth.signInWithEmailAndPassword(document.getElementById('adminEmail').value, document.getElementById('adminPass').value); }

        function init() {
            loadAds(); loadTokens(); loadUsers();
        }

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // --- ADS ---
        function saveAd() {
            const ad = {
                type: document.getElementById('ad-type').value,
                header: document.getElementById('ad-header').value,
                url: document.getElementById('ad-url').value,
                duration: document.getElementById('ad-duration').value,
                socialLinks: {
                    whatsapp: document.getElementById('ad-wa').value,
                    telegram: document.getElementById('ad-tg').value,
                    youtube: document.getElementById('ad-yt').value
                },
                timestamp: Date.now()
            };
            db.ref('ads').push(ad).then(() => { showToast("Ad Added!"); loadAds(); });
        }

        function loadAds() {
            db.ref('ads').on('value', snap => {
                const list = document.getElementById('ads-list'); list.innerHTML = '';
                snap.forEach(c => {
                    list.innerHTML += `<div class="item-row"><span>${c.val().header}</span><i class="fas fa-trash" style="color:red" onclick="del('ads/${c.key}')"></i></div>`;
                });
            });
        }

        // --- TOKENS ---
        function generateTokens() {
            const val = document.getElementById('tk-value').value;
            const unit = document.getElementById('tk-unit').value;
            const count = document.getElementById('tk-count').value;
            for(let i=0; i<count; i++) {
                const tk = 'STANY-' + Math.random().toString(36).substr(2, 9).toUpperCase();
                db.ref('tokens/' + tk).set({ status: 'unused', durationValue: val, durationUnit: unit });
            }
            showToast("Tokens Created!");
        }

        function loadTokens() {
            db.ref('tokens').on('value', snap => {
                const list = document.getElementById('tk-list'); list.innerHTML = '<h4>Premium Tokens</h4>';
                snap.forEach(c => {
                    const d = c.val();
                    const statusColor = d.status === 'used' ? 'gray' : 'lime';
                    const usedLabel = d.usedBy ? `<span class="user-label">Used by: ${d.usedBy}</span>` : "";
                    list.innerHTML += `<div class="item-row">
                        <div>
                            <span class="token-code">${c.key}</span>
                            <small>(${d.durationValue} ${d.durationUnit})</small>
                            ${usedLabel}
                        </div>
                        <div style="display:flex; gap:15px; align-items:center;">
                            <b style="color:${statusColor}">${d.status}</b>
                            <i class="fas fa-copy" onclick="copyTxt('${c.key}')"></i>
                        </div>
                    </div>`;
                });
            });
        }

        // --- LIBRARY ---
        function addEpField() {
            const div = document.createElement('div');
            div.className = 'ep-row';
            div.style = "background:#000; padding:15px; border-radius:15px; margin-bottom:10px;";
            div.innerHTML = `<input class="ep-title input-box" placeholder="Part Title"><textarea class="ep-content input-box" rows="4" placeholder="Content..."></textarea>`;
            document.getElementById('ep-container').appendChild(div);
        }

        function saveLibrary() {
            const eps = [];
            document.querySelectorAll('.ep-row').forEach(row => {
                eps.push({ partTitle: row.querySelector('.ep-title').value, content: row.querySelector('.ep-content').value });
            });
            const data = {
                category: document.getElementById('lib-cat').value,
                title: document.getElementById('lib-title').value,
                author: document.getElementById('lib-author').value,
                episodes: eps
            };
            db.ref('library').push(data).then(() => showToast("Book Saved!"));
        }

        // --- CONTENT ---
        function saveContent() {
            const type = document.getElementById('ch-type').value;
            const data = {
                name: document.getElementById('ch-name').value,
                title: document.getElementById('ch-name').value,
                streamURL: document.getElementById('ch-url').value,
                movieURL: document.getElementById('ch-url').value,
                logo: document.getElementById('ch-logo').value,
                posterURL: document.getElementById('ch-logo').value,
                playerType: document.getElementById('ch-player').value,
                licenseURL: document.getElementById('ch-license').value,
                tokenID: document.getElementById('ch-token').value
            };
            db.ref(type).push(data).then(() => showToast("Content Saved!"));
        }

        // --- USERS ---
        function loadUsers() {
            db.ref('users').on('value', snap => {
                const list = document.getElementById('user-list'); list.innerHTML = '';
                snap.forEach(c => {
                    const u = c.val();
                    list.innerHTML += `<div class="item-row">
                        <div><b>${u.name}</b><br><small>${u.email}</small></div>
                        <div style="text-align:right">
                            <small style="display:block; color:yellow">Lock-Pass: ${u.secretPassword || 'NONE'}</small>
                            <button class="btn btn-d" style="font-size:10px; padding:5px 10px; margin-top:5px;" onclick="resetHWID('${c.key}')">RESET HWID</button>
                        </div>
                    </div>`;
                });
            });
        }

        function resetHWID(uid) { db.ref('users/'+uid).update({ hwid: "" }).then(() => showToast("HWID Reset!")); }

        // UTILS
        function copyTxt(t) { navigator.clipboard.writeText(t); showToast("Copied!"); }
        function del(path) { if(confirm("Confirm Delete?")) db.ref(path).remove().then(() => showToast("Deleted!")); }
        function showToast(m) { const t = document.getElementById('toast'); t.innerText=m; t.style.display='block'; setTimeout(()=>t.style.display='none', 2000); }
    </script>
</body>
</html>
