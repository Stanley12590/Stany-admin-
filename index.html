<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STANY MIN ADMIN - ULTIMATE SUPREME</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #FF0000;
            --bg: #000000;
            --card: #0a0a0a;
            --border: #1a1a1a;
            --text: #ffffff;
            --gray: #888;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Outfit', sans-serif; outline: none; }
        body { background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }

        /* SIDEBAR */
        .sidebar { width: 260px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; }
        .nav-item { padding: 12px 15px; border-radius: 15px; cursor: pointer; margin-bottom: 5px; display: flex; align-items: center; gap: 12px; color: #888; transition: 0.3s; font-size: 0.9em; font-weight: 600; }
        .nav-item:hover, .nav-item.active { background: var(--primary); color: #fff; }

        /* MAIN CONTENT */
        .main { flex: 1; overflow-y: auto; padding: 30px; padding-bottom: 100px; -webkit-overflow-scrolling: touch; }
        .section { display: none; }
        .section.active { display: block; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS & INPUTS */
        .app-card { background: var(--card); border: 1px solid var(--border); padding: 25px; border-radius: 25px; margin-bottom: 25px; }
        .input-box, .select-modern { width: 100%; padding: 14px; background: #000; border: 1px solid #222; color: white; border-radius: 15px; margin-bottom: 15px; font-size: 0.9em; }
        .btn { padding: 12px 25px; border-radius: 18px; border: none; font-weight: 800; cursor: pointer; background: var(--primary); color: #fff; transition: 0.3s; }
        .btn-d { background: #222; }

        /* LIST ITEMS */
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #050505; border: 1px solid #111; border-radius: 18px; margin-bottom: 10px; }
        .token-info b { color: var(--primary); font-family: monospace; font-size: 1.1em; }
        .user-tag { font-size: 11px; color: #555; display: block; margin-top: 4px; }
        .unread-badge { background: var(--primary); color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; }

        .ep-row { background: #000; padding: 15px; border-radius: 15px; border-left: 4px solid var(--primary); margin-bottom: 10px; }

        /* AUTH */
        #authOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 30000; display: flex; justify-content: center; align-items: center; }

        #toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: var(--primary); color: white; padding: 10px 30px; border-radius: 30px; z-index: 50000; display: none; font-weight: 800; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }
    </style>
</head>
<body>

    <!-- 1. AUTH OVERLAY -->
    <div id="authOverlay">
        <div class="app-card" style="width:350px; text-align:center;">
            <h2 style="color:var(--primary); margin-bottom:20px; font-family: 'Orbitron';">ADMIN PORTAL</h2>
            <input type="email" id="adminEmail" class="input-box" placeholder="Email">
            <input type="password" id="adminPass" class="input-box" placeholder="Password">
            <button class="btn" style="width: 100%;" onclick="login()">ENTER PANEL</button>
        </div>
    </div>

    <!-- 2. SIDEBAR -->
    <div class="sidebar">
        <h1 style="color:var(--primary); font-family:'Orbitron'; font-size:20px; margin-bottom:30px;">STANY ADMIN</h1>
        <div class="nav-item active" onclick="showSection('ads')"><i class="fas fa-ad"></i>Ads Pool</div>
        <div class="nav-item" onclick="showSection('tokens')"><i class="fas fa-key"></i>Token Factory</div>
        <div class="nav-item" onclick="showSection('library')"><i class="fas fa-book"></i>Library Builder</div>
        <div class="nav-item" onclick="showSection('content')"><i class="fas fa-film"></i>Content Control</div>
        <div class="nav-item" onclick="showSection('chat')"><i class="fas fa-comments"></i>Support Chat</div>
        <div class="nav-item" onclick="showSection('users')"><i class="fas fa-users-cog"></i>User HWID & Pass</div>
        <div class="nav-item" onclick="showSection('carousel')"><i class="fas fa-images"></i>Carousel</div>
        <div class="nav-item" style="margin-top:auto; color:red" onclick="auth.signOut()"><i class="fas fa-sign-out-alt"></i>Logout</div>
    </div>

    <!-- 3. MAIN AREA -->
    <div class="main">
        
        <!-- SECTION: ADS -->
        <div id="ads" class="section active">
            <h2>Ultimate Ads Pool</h2>
            <div class="app-card">
                <select id="ad-type" class="select-modern"><option value="image">Image</option><option value="video">Video</option></select>
                <input id="ad-header" class="input-box" placeholder="Header Text (e.g. SPECIAL OFFER)">
                <input id="ad-url" class="input-box" placeholder="Media Link (Image/Video URL)">
                <input id="ad-duration" type="number" class="input-box" placeholder="Duration (Seconds)">
                <label>Sponsor Social Links (Weka platform na URL)</label>
                <div id="social-inputs">
                    <input class="input-box" id="ad-link-wa" placeholder="WhatsApp Link">
                    <input class="input-box" id="ad-link-tg" placeholder="Telegram Link">
                </div>
                <button class="btn" onclick="saveAd()">ADD TO RANDOM POOL</button>
            </div>
            <div id="ads-list"></div>
        </div>

        <!-- SECTION: TOKENS -->
        <div id="tokens" class="section">
            <h2>Premium Token Factory</h2>
            <div class="app-card">
                <div style="display: flex; gap:10px;">
                    <input id="tk-value" type="number" class="input-box" placeholder="Duration Value">
                    <select id="tk-unit" class="select-modern">
                        <option value="seconds">Seconds</option>
                        <option value="minutes">Minutes</option>
                        <option value="hours" selected>Hours</option>
                        <option value="days">Days</option>
                    </select>
                </div>
                <input id="tk-count" type="number" class="input-box" placeholder="How many tokens?">
                <button class="btn" onclick="generateTokens()">CREATE UNIQUE TOKENS</button>
            </div>
            <div id="tk-list"></div>
        </div>

        <!-- SECTION: LIBRARY BUILDER -->
        <div id="library" class="section">
            <h2>Simulizi & Tech Builder (Episodes)</h2>
            <div class="app-card">
                <select id="lib-cat" class="select-modern"><option value="simulizi">Simulizi (Stories)</option><option value="tech">Tech Update</option></select>
                <input id="lib-title" class="input-box" placeholder="Book Title">
                <input id="lib-author" class="input-box" placeholder="Author Name">
                <textarea id="lib-desc" class="input-box" placeholder="About / Summary..."></textarea>
                <div id="ep-container">
                    <div class="ep-row">
                        <input class="ep-title input-box" placeholder="Part 1 Title">
                        <textarea class="ep-content input-box" rows="4" placeholder="Part 1 Content..."></textarea>
                    </div>
                </div>
                <button class="btn btn-d" onclick="addEpField()">+ ADD NEXT PART</button>
                <button class="btn" onclick="saveLibrary()">PUBLISH TO USER APP</button>
            </div>
        </div>

        <!-- SECTION: CONTENT -->
        <div id="content" class="section">
            <h2>Movies & Adult Manager</h2>
            <div class="app-card">
                <select id="ch-type" class="select-modern"><option value="movies">Regular Movie</option><option value="adultContent">Adult (18+)</option><option value="channels">Live Channel</option></select>
                <input id="ch-name" class="input-box" placeholder="Title/Name">
                <input id="ch-url" class="input-box" placeholder="Stream/Movie URL">
                <input id="ch-logo" class="input-box" placeholder="Poster/Logo URL">
                <select id="ch-player" class="select-modern"><option value="internal">Standard</option><option value="drm">DRM Pro (Shaka)</option></select>
                <input id="ch-license" class="input-box" placeholder="DRM License URL (Widevine)">
                <input id="ch-token" class="input-box" placeholder="Token ID (Bearer)">
                <button class="btn" onclick="saveContent()">SAVE CONTENT</button>
            </div>
            <div id="content-list"></div>
        </div>

        <!-- SECTION: CHAT -->
        <div id="chat" class="section">
            <h2>Support & Group Chat Management</h2>
            <div id="chat-list"></div>
            <!-- Reply Area -->
            <div id="reply-area" style="display:none;" class="app-card">
                <h4 id="reply-to-user">Reply to User</h4>
                <textarea id="reply-text" class="input-box" rows="3"></textarea>
                <button class="btn" onclick="sendReply()">SEND REPLY</button>
            </div>
        </div>

        <!-- SECTION: USERS -->
        <div id="users" class="section">
            <h2>Hardware Security (HWID) Control</h2>
            <div id="user-list"></div>
        </div>

        <!-- SECTION: CAROUSEL -->
        <div id="carousel" class="section">
            <h2>Home Screen Carousel</h2>
            <div class="app-card">
                <input id="car-img" class="input-box" placeholder="Image URL">
                <button class="btn" onclick="saveCarousel()">ADD SLIDE</button>
            </div>
            <div id="car-list"></div>
        </div>

    </div>

    <div id="toast">Saved!</div>

    <script>
        // CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyDiexD5WK9GLhQldr6zNmC8iYWc4em5eyM",
            authDomain: "stany-min-tv.firebaseapp.com",
            databaseURL: "https://stany-min-tv-default-rtdb.firebaseio.com",
            projectId: "stany-min-tv",
            storageBucket: "stany-min-tv.firebasestorage.app",
            messagingSenderId: "16513327552",
            appId: "1:16513327552:web:b4b2247053f83aa0b8e825"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database(), auth = firebase.auth();

        auth.onAuthStateChanged(u => {
            if(u) { document.getElementById('authOverlay').style.display='none'; init(); }
            else { document.getElementById('authOverlay').style.display='flex'; }
        });

        function login() { auth.signInWithEmailAndPassword(document.getElementById('adminEmail').value, document.getElementById('adminPass').value); }

        function init() {
            loadAds(); loadTokens(); loadUsers(); loadSupportList(); loadCarousel(); loadList('movies'); loadList('adultContent'); loadList('channels');
        }

        // --- ADS MANAGER ---
        function saveAd() {
            const ad = {
                type: document.getElementById('ad-type').value,
                header: document.getElementById('ad-header').value,
                url: document.getElementById('ad-url').value,
                duration: parseInt(document.getElementById('ad-duration').value),
                socialLinks: {
                    whatsapp: document.getElementById('ad-link-wa').value,
                    telegram: document.getElementById('ad-link-tg').value
                }
            };
            db.ref('ads').push(ad).then(() => { showToast("Ad Created!"); loadAds(); });
        }

        function loadAds() {
            db.ref('ads').on('value', snap => {
                const list = document.getElementById('ads-list'); list.innerHTML = '';
                snap.forEach(c => {
                    list.innerHTML += `<div class="item-row"><span>${c.val().header} (${c.val().type})</span><i class="fas fa-trash" style="color:red" onclick="del('ads/${c.key}')"></i></div>`;
                });
            });
        }

        // --- TOKEN FACTORY ---
        function generateTokens() {
            const v = document.getElementById('tk-value').value;
            const u = document.getElementById('tk-unit').value;
            const c = document.getElementById('tk-count').value;
            for(let i=0; i<c; i++) {
                const tk = 'TK-' + Math.random().toString(36).substr(2, 9).toUpperCase();
                db.ref('tokens/' + tk).set({ status: 'unused', durationValue: v, durationUnit: u });
            }
            showToast("Tokens Ready!");
        }

        function loadTokens() {
            db.ref('tokens').on('value', snap => {
                const list = document.getElementById('tk-list'); list.innerHTML = '<h4>Latest Tokens</h4>';
                snap.forEach(c => {
                    const d = c.val();
                    const color = d.status === 'used' ? 'gray' : 'lime';
                    const user = d.usedBy ? `<span class="user-tag">Used by: ${d.usedBy}</span>` : "";
                    list.innerHTML += `<div class="item-row">
                        <div class="token-info"><b>${c.key}</b> ${user}</div>
                        <div style="display:flex; align-items:center; gap:15px">
                            <small style="color:${color}">${d.status.toUpperCase()}</small>
                            <i class="fas fa-copy" onclick="copyText('${c.key}')"></i>
                        </div>
                    </div>`;
                });
            });
        }

        // --- LIBRARY ---
        function addEpField() {
            const div = document.createElement('div'); div.className = 'ep-row';
            div.innerHTML = `<input class="ep-title input-box" placeholder="Part Title"><textarea class="ep-content input-box" rows="4" placeholder="Content..."></textarea>`;
            document.getElementById('ep-container').appendChild(div);
        }

        function saveLibrary() {
            const eps = [];
            document.querySelectorAll('.ep-row').forEach(row => {
                eps.push({ partTitle: row.querySelector('.ep-title').value, content: row.querySelector('.ep-content').value });
            });
            const data = {
                category: document.getElementById('lib-cat').value,
                title: document.getElementById('lib-title').value,
                author: document.getElementById('lib-author').value,
                description: document.getElementById('lib-desc').value,
                episodes: eps
            };
            db.ref('library').push(data).then(() => showToast("Book Published!"));
        }

        // --- HWID ---
        function loadUsers() {
            db.ref('users').on('value', snap => {
                const list = document.getElementById('user-list'); list.innerHTML = '';
                snap.forEach(c => {
                    const u = c.val();
                    list.innerHTML += `<div class="item-row">
                        <div><b>${u.name}</b><br><small>${u.email}</small></div>
                        <div style="text-align:right">
                            <small style="display:block; color:yellow">Secret Pass: ${u.secretPassword || 'N/A'}</small>
                            <button class="btn btn-d" style="font-size:10px; padding:5px; margin-top:5px;" onclick="resetHWID('${c.key}')">RESET HWID</button>
                        </div>
                    </div>`;
                });
            });
        }

        function resetHWID(uid) { db.ref('users/'+uid).update({ hwid: "" }).then(() => showToast("Reset Done!")); }

        // UTILS
        function showSection(id) { document.querySelectorAll('.section').forEach(s => s.classList.remove('active')); document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); document.getElementById(id).classList.add('active'); event.currentTarget.classList.add('active'); }
        function saveContent() {
            const type = document.getElementById('ch-type').value;
            const data = { name: document.getElementById('ch-name').value, title: document.getElementById('ch-name').value, streamURL: document.getElementById('ch-url').value, movieURL: document.getElementById('ch-url').value, logo: document.getElementById('ch-logo').value, posterURL: document.getElementById('ch-logo').value, playerType: document.getElementById('ch-player').value, licenseURL: document.getElementById('ch-license').value, tokenID: document.getElementById('ch-token').value };
            db.ref(type).push(data).then(() => showToast("Saved!"));
        }
        function loadList(path) { /* List generator logic as per old features */ }
        function del(p) { if(confirm("Del?")) db.ref(p).remove().then(() => showToast("Deleted!")); }
        function copyText(t) { navigator.clipboard.writeText(t); showToast("Copied!"); }
        function showToast(m) { const t = document.getElementById('toast'); t.innerText=m; t.style.display='block'; setTimeout(()=>t.style.display='none', 2000); }
        function login() { auth.signInWithEmailAndPassword(document.getElementById('adminEmail').value, document.getElementById('adminPass').value); }
    </script>
</body>
</html>
